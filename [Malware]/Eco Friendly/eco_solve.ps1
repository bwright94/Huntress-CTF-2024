# Path to the ps1 file containing the command to execute
$commandFilePath = "C:\Users\kali\Downloads\eco_friendly"

# Check if the command file exists
if (-not (Test-Path $commandFilePath)) {
    Write-Host "Command file not found: $commandFilePath"
    exit
}

# Read the command from the file
$command = Get-Content -Path $commandFilePath -Raw

# Run the command and capture the output
try {
    $output = Invoke-Expression $command
} catch {
    Write-Host "An error occurred while executing the command: $_"
    exit
}

# Ensure the output is a single line by removing any line breaks
$output = $output -replace "`r`n", " " -replace "`n", " " -replace "`r", " "

# Path to save the output
$outputFilePath = "C:\Users\kali\Downloads\eco_output1.ps1"

# Write the output to the new file as a single line
$output | Out-File -FilePath $outputFilePath -Encoding utf8

Write-Host "Output saved to $outputFilePath"
